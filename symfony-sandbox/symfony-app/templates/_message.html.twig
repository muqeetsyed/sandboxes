{% if message.role.value == 'assistant' %}
    {{ _self.bot(message.content, latest: latest) }}
{% else %}
    {{ _self.user(message.content) }}
{% endif %}

{% macro bot(content, loading = false, latest = false, contentId = null, messageId = null) %}
    <div{% if messageId %} id="{{ messageId }}"{% endif %}>
        <div class="ps-2">
            {% if loading %}
                <div>
                    <i>{{ content }}</i>
                </div>
            {% else %}
                <div {% if contentId %} id="{{ contentId }}"{% endif %}>
                    {% if latest and app.request.xmlHttpRequest %}
                        <span
                                data-controller="symfony--ux-typed"
                                data-symfony--ux-typed-show-cursor-value="false"
                                data-symfony--ux-typed-type-speed-value="0"
                                data-symfony--ux-typed-strings-value="{{ [content|markdown_to_html]|json_encode|e('html_attr') }}"
                        ></span>
                    {% else %}
                        {{ content|markdown_to_html }}
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
{% endmacro %}

{% macro user(content, loading = false) %}
    <div>
        <div class="pe-2">
            {% for item in content %}
                <div>
                    {% if loading %}
                        <span></span><i>{{ item.text }}</i>
                    {% else %}
                        {{ item.text }}
                    {% endif %}
                </div>
            {% endfor %}
        </div>
    </div>
{% endmacro %}
